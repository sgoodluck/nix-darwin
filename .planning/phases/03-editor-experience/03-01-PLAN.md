---
phase: 03-editor-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - dotfiles/nvim/lua/plugins/fzf-lua.lua
  - dotfiles/nvim/lua/plugins/gitsigns.lua
  - dotfiles/nvim/lua/plugins/neo-tree.lua
  - dotfiles/nvim/lua/config/keymaps.lua
autonomous: true
requirements:
  - FIND-01
  - FIND-02
  - FIND-03
  - GIT-01
  - GIT-02
  - TREE-01
  - TREE-02

must_haves:
  truths:
    - "fzf-lua plugin spec exists with keys trigger for files, live_grep, buffers, and keymaps pickers"
    - "gitsigns plugin spec exists with BufReadPre event, custom sign characters, and hunk navigation keymaps"
    - "neo-tree plugin spec exists with toggle keybind, filesystem-only source, and init BufEnter autocmd"
    - "netrw `-` keymap removed from keymaps.lua"
  artifacts:
    - path: "dotfiles/nvim/lua/plugins/fzf-lua.lua"
      provides: "fzf-lua lazy.nvim plugin spec"
      contains: "ibhagwan/fzf-lua"
    - path: "dotfiles/nvim/lua/plugins/gitsigns.lua"
      provides: "gitsigns lazy.nvim plugin spec"
      contains: "lewis6991/gitsigns.nvim"
    - path: "dotfiles/nvim/lua/plugins/neo-tree.lua"
      provides: "neo-tree lazy.nvim plugin spec"
      contains: "nvim-neo-tree/neo-tree.nvim"
  key_links:
    - from: "dotfiles/nvim/lua/plugins/fzf-lua.lua"
      to: "fzf-lua pickers"
      via: "keys trigger loading"
      pattern: "FzfLua files"
    - from: "dotfiles/nvim/lua/plugins/gitsigns.lua"
      to: "gitsigns on_attach"
      via: "BufReadPre event trigger"
      pattern: "nav_hunk"
    - from: "dotfiles/nvim/lua/plugins/neo-tree.lua"
      to: "Neotree toggle command"
      via: "keys trigger + init BufEnter autocmd"
      pattern: "Neotree toggle"
---

<objective>
Create fzf-lua, gitsigns, and neo-tree plugin specs for lazy.nvim and clean up the netrw keymap.

Purpose: All three Phase 3 plugins are independent lazy.nvim specs in separate files. Creating them in one plan keeps configuration work together before the rebuild/verify cycle.
Output: Three new plugin files in lua/plugins/ and an updated keymaps.lua with the netrw bind removed.
</objective>

<execution_context>
@/Users/sgoodluck/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sgoodluck/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-editor-experience/03-CONTEXT.md
@.planning/phases/03-editor-experience/03-RESEARCH.md

Source files to modify:
@dotfiles/nvim/lua/config/keymaps.lua
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create fzf-lua, gitsigns, and neo-tree plugin specs</name>
  <files>
    dotfiles/nvim/lua/plugins/fzf-lua.lua
    dotfiles/nvim/lua/plugins/gitsigns.lua
    dotfiles/nvim/lua/plugins/neo-tree.lua
  </files>
  <action>
Create three plugin spec files following the established pattern (one file per plugin, returns a lazy.nvim spec table).

**fzf-lua.lua** — Fuzzy finder replacing fzf.vim and telescope:
- Plugin: `"ibhagwan/fzf-lua"` with dependency `"nvim-tree/nvim-web-devicons"`
- Lazy load via `cmd = "FzfLua"` and `keys` triggers:
  - `<leader>ff` → `<cmd>FzfLua files<CR>` (desc: "Find files")
  - `<leader>fg` → `<cmd>FzfLua live_grep<CR>` (desc: "Live grep")
  - `<leader>fb` → `<cmd>FzfLua buffers<CR>` (desc: "Buffers")
  - `<leader>fc` → `<cmd>FzfLua keymaps<CR>` (desc: "Keymaps (command palette)")
- `opts.winopts`: centered floating window (width=0.8, height=0.8, row=0.5, col=0.5, border="rounded")
- Preview pane on the right: `preview = { layout = "horizontal", horizontal = "right:50%" }`
- IMPORTANT: Use `layout = "horizontal"` not "vertical" — "horizontal" puts preview on the right side

**gitsigns.lua** — Git gutter signs and hunk navigation:
- Plugin: `"lewis6991/gitsigns.nvim"`
- Lazy load via `event = "BufReadPre"` (not VeryLazy — signs must appear before first buffer display)
- `opts.signs`: `add = { text = "+" }`, `change = { text = "~" }`, `delete = { text = "-" }`, `topdelete = { text = "-" }`, `changedelete = { text = "~" }`, `untracked = { text = "?" }`
- `opts.on_attach` callback with `bufnr` parameter:
  - Create a local `map(mode, l, r, desc)` helper that sets `{ buffer = bufnr, desc = desc }`
  - `]h` → next hunk with diff-mode guard: if `vim.wo.diff` then `vim.cmd.normal({ "]h", bang = true })` else `gs.nav_hunk("next")`
  - `[h` → prev hunk with same diff-mode guard pattern
  - `<leader>gs` → `gs.stage_hunk` (desc: "Stage hunk")
  - `<leader>gr` → `gs.reset_hunk` (desc: "Reset hunk")
  - `<leader>gp` → `gs.preview_hunk` (desc: "Preview hunk")
- IMPORTANT: Always check `vim.wo.diff` before calling `nav_hunk` — without this guard, `]h`/`[h` break in `:Gitsigns diffthis` view

**neo-tree.lua** — Toggleable file tree sidebar:
- Plugin: `"nvim-neo-tree/neo-tree.nvim"` with `branch = "v3.x"`
- Dependencies: `"nvim-lua/plenary.nvim"`, `"MunifTanjim/nui.nvim"`, `"nvim-tree/nvim-web-devicons"`
- Lazy load via `cmd = "Neotree"` and `keys = { { "<leader>e", "<cmd>Neotree toggle<CR>", desc = "Toggle file tree" } }`
- `init` function (runs at startup, before load): register a `once = true` BufEnter autocmd in a `neotree_start_directory` augroup. The callback checks if neo-tree is already loaded (`package.loaded["neo-tree"]`), then checks if `vim.fn.argv(0)` is a directory via `vim.uv.fs_stat()`, and if so calls `require("neo-tree")`. This handles `nvim /some/dir` correctly without eagerly loading the plugin.
- `opts.sources = { "filesystem" }` — filesystem only, no buffers/git_status tabs
- `opts.close_if_last_window = true`
- `opts.window = { position = "left", width = 30 }`
- `opts.filesystem = { follow_current_file = { enabled = true }, use_libuv_file_watcher = true }`
- `opts.default_component_configs.git_status.symbols`: added="", modified="", deleted="✖", renamed="󰁕", untracked="", ignored="", unstaged="󰄱", staged="", conflict=""
  </action>
  <verify>
    <automated>ls -la dotfiles/nvim/lua/plugins/fzf-lua.lua dotfiles/nvim/lua/plugins/gitsigns.lua dotfiles/nvim/lua/plugins/neo-tree.lua && grep -c "ibhagwan/fzf-lua" dotfiles/nvim/lua/plugins/fzf-lua.lua && grep -c "lewis6991/gitsigns.nvim" dotfiles/nvim/lua/plugins/gitsigns.lua && grep -c "nvim-neo-tree/neo-tree.nvim" dotfiles/nvim/lua/plugins/neo-tree.lua</automated>
  </verify>
  <done>Three plugin spec files exist with correct plugin names, lazy load triggers, keymaps, and opts matching all user decisions</done>
</task>

<task type="auto">
  <name>Task 2: Remove netrw keymap from keymaps.lua</name>
  <files>dotfiles/nvim/lua/config/keymaps.lua</files>
  <action>
Remove the line `vim.keymap.set("n", "-", ":Ex<CR>", { desc = "File explorer (netrw)" })` from `dotfiles/nvim/lua/config/keymaps.lua`. This netrw bind is replaced by neo-tree's `<leader>e` toggle. Also remove the `-- File explorer` comment line above it.

Do NOT modify any other keymaps — leave `<leader>w`, `<leader>q`, `<leader>h`, `<C-hjkl>`, and visual indenting intact.
  </action>
  <verify>
    <automated>grep -c "netrw\|:Ex" dotfiles/nvim/lua/config/keymaps.lua | grep -q "^0$" && echo "PASS: netrw removed" || echo "FAIL: netrw still present"</automated>
  </verify>
  <done>The `-` netrw keymap and its comment are removed. All other keymaps in the file remain unchanged.</done>
</task>

</tasks>

<verification>
1. All three plugin files exist under `dotfiles/nvim/lua/plugins/`
2. Each file returns a valid Lua table (lazy.nvim spec)
3. fzf-lua has 4 key bindings: `<leader>ff`, `<leader>fg`, `<leader>fb`, `<leader>fc`
4. gitsigns has `event = "BufReadPre"` and `on_attach` with `]h`/`[h` hunk navigation
5. neo-tree has `<leader>e` toggle, `init` BufEnter autocmd, filesystem-only source
6. keymaps.lua no longer contains the `-` netrw bind
7. No conflicts with existing keymaps (`<leader>w`, `<leader>q`, `<leader>h`, `<leader>l*`, `<C-hjkl>`)
</verification>

<success_criteria>
- Three new files in lua/plugins/ following established one-file-per-plugin pattern
- All user-specified keybinds present with correct desc strings
- Netrw keymap removed from keymaps.lua
- No syntax errors in any Lua file
</success_criteria>

<output>
After completion, create `.planning/phases/03-editor-experience/03-01-SUMMARY.md`
</output>
